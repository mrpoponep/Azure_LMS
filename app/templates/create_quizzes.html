{% extends 'base.html' %}

{% from 'macro.html' import page_header, input, text_area %}

{% block title %}
    LMS - New Content
{% endblock title %}

{% block content %}

    {{ page_header("New Content") }}
    <form action="{{ url_for('create_quizz', CourseID=CourseID) }}" method="POST" id="quizForm">
        <style>
            .option-input {
                margin-bottom: 10px;  /* Adjust the margin-bottom value as needed */
            }
        </style>
            {{ input(name="Title", label="Title", required=true) }}
        
        <div id="questionsContainer">
            <!-- Existing form fields for the first question -->
            <label for="questions[0].content">Question Content:</label>
            <input type="text" id="questions[0].content" name="questions[0].content" required autocomplete="off">
            <label for="questions[0].type">Question Type:</label>
            <select id="questions[0].type" name="questions[0].type" onchange="handleQuestionTypeChange(this, 0)" >
                <option value="short_answer">Short Answer</option>
                <option value="multiple_choice">Multiple Choice</option>
            </select>
            <br>
            
            <div class="options-container" id="optionsContainer-0" style="display: none;">
                <label>Options:</label>
                <br>
                <input class="option-input" type="text" name="questions[0].options[]"  >
                <br>
                <input class="option-input" name="questions[0].options[]" >
                <br>
                <!-- Add more input fields for options as needed -->
            </div>
            <label for="questions[0].answer">Correct Answer:</label>
            <input type="text" id="questions[0].answer" name="questions[0].answer" required autocomplete="off">
        </div>
        <br>
        <button type="button" onclick="addQuestion()">Add Question</button>
        <br>
        <button type="submit" class="btn btn-success btn-block">Submit</button>
        <input type="hidden" name="questionCounter" id="questionCounter" value="1">
    </form>

    <script>
        let questionCounter = 1;
        
        function addQuestion() {
            const questionsContainer = document.getElementById('questionsContainer');
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question';
    
            questionDiv.innerHTML = `
            <br>
                <label for="questions[${questionCounter}].content">Question Content:</label>
                <input type="text" id="questions[${questionCounter}].content" name="questions[${questionCounter}].content" required autocomplete="off">
                <label for="questions[${questionCounter}].type">Question Type:</label>
                <select id="questions[${questionCounter}].type" name="questions[${questionCounter}].type" onchange="handleQuestionTypeChange(this, ${questionCounter})" required>
                    <option value="short_answer">Short Answer</option>
                    <option value="multiple_choice">Multiple Choice</option>
                </select>
                <br>
                
                <div class="options-container" id="optionsContainer-${questionCounter}" style="display: none;" autocomplete="off">
                    <label>Options:</label>
                    <br>
                    <input class="option-input" type="text" name="questions[${questionCounter}].options[]" >
                    <br>
                    <input class="option-input" type="text" name="questions[${questionCounter}].options[]" >
                    <br>
                    <!-- Add more input fields for options as needed -->
                </div>
                <label for="questions[${questionCounter}].answer">Correct Answer:</label>
                <input type="text" id="questions[${questionCounter}].answer" name="questions[${questionCounter}].answer" required autocomplete="off"> 
                <br>
                <button type="button" onclick="addOption(${questionCounter})" style="display: none;">Add Option</button>
            `;
    
            questionsContainer.appendChild(questionDiv);
            questionCounter++;
        }
    
        function handleQuestionTypeChange(selectElement, questionIndex) {
            const optionsContainer = document.getElementById(`optionsContainer-${questionIndex}`);
            const addOptionButton = selectElement.nextElementSibling.nextElementSibling.nextElementSibling;
            if (selectElement.value === 'multiple_choice') {
                optionsContainer.style.display = 'block';
                addOptionButton.style.display = 'block';
            } else {
                optionsContainer.style.display = 'none';
                addOptionButton.style.display = 'none';
            }
        }

    </script>

{% endblock content %}